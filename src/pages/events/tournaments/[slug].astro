---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import Layout from '@layouts/Layout.astro';
import Text from '@components/Text.astro';
import { formatDateRange } from '@utils/dates';

export async function getStaticPaths() {
  const events = await getCollection('events', ({ data }) => data.eventType === 'tournament' && !data.external);
  return events.map((event) => ({
    params: { slug: event.slug },
    props: { event },
  }));
}

const { event } = Astro.props;
const { Content } = await event.render();
---

<Layout
  title={event.data.title}
  subtitle={formatDateRange(event.data.date, event.data.endDate)}
  cmsPath={`/collections/events/entries/${event.slug}`}
>
  {event.data.heroImage && (
    <Image
      src={event.data.heroImage}
      alt={event.data.title}
      class="w-full max-h-96 object-contain rounded-lg my-8"
      inferSize={true}
    />
  )}

  <Text>
    <Content />
  </Text>
</Layout>
